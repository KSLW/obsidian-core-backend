#!/usr/bin/env node

var fs = require('fs')
var path = require('path')
var crypto = require('crypto')
var outPath = path.resolve(__dirname, 'newFixtures.json')

var IV_SIZE = 16
var KEY_SIZE = 32
var validInputs = [
  {
    iv: null,
    newValidKey()
  }
]

for (var i = 0; i < 5; i++) {
  validInputs.push({
    iv: newValidIV(),
    key: newValidKey()
  })
}

var plaintexts = []
for (var i = 0; i < 4; i++) {
  // various even and odd lengths
  plaintexts.push(r(Math.pow(i, 10) + 1))
}

for (i = 0; i < 10; i++) {
  // powers of 2
  plaintexts.push(r(Math.pow(i, 2)))
}

var invalidIVs = [
  r(15),
  r(20),
  r(32)
]

var invalidKeys = [
  null,
  r(15),
  r(33),
  r(64)
]

var out = {
  valid: validInputs,
  invalid: {
    ivs: invalidIVs,
    keys: invalidKeys
  },
  plaintexts: plaintexts
}

fs.writeFile(outPath, JSON.stringify(out, null, 2))

function newValidKey () {
  return r(KEY_SIZE)
}

function newValidIV () {
  return r(IV_SIZE)
}

function r (size) {
  return crypto.randomBytes(size).toString('hex')
}
