FROM mhart/alpine-node:4.2.4

RUN apk add --update make python

# use changes to package.json to force Docker not to use the cache
# when we change our application's nodejs dependencies:

RUN mkdir -p /opt/app
WORKDIR /opt/app

ADD package.json /opt/app/
RUN cd /opt/app && npm install

# From here we load our application's code in, therefore the previous docker
# "layer" thats been cached will be used if possible

ADD . /opt/app

# put before npm install, to avoid installing devDependencies
# after leveldown prebuild script stops failing
# ENV NODE_ENV production

CMD ["sh", "run.sh"]
